# Astro static site Nginx config example
# This is a template - do not use directly; sed or envsubst will replace placeholders

server {
    listen 80;

    server_name {DOMAIN};

    root {ROOT_PATH};  # e.g. /var/www/my-astro-site/dist

    index index.html index.htm;

    # Enable gzip compression for better performance
    gzip on;
    gzip_types text/plain text/css application/javascript text/xml application/xml application/rss+xml application/atom+xml image/svg+xml;
    gzip_vary on;
    gzip_proxied any;
    gzip_comp_level 6;
    gzip_buffers 16 8k;
    gzip_http_version 1.1;

    # Cache static assets
    location ~* \.(jpg|jpeg|png|gif|ico|css|js|svg|woff|woff2|ttf|eot)$ {
        expires 30d;
        access_log off;
        add_header Cache-Control "public";
    }

    # Main location - handle SPA routing (try_files for Astro)
    location / {
        try_files $uri $uri/ /index.html;
    }

    # Optional: Deny access to hidden files
    location ~ /\. {
        deny all;
    }

    # Optional: Security headers
    add_header X-Content-Type-Options nosniff;
    add_header X-Frame-Options SAMEORIGIN;
    add_header X-XSS-Protection "1; mode=block";

    # SSL block (uncomment and replace paths when enabling HTTPS)
    # listen 443 ssl http2;
    #
    # ssl_certificate     {SSL_CERT_PATH};
    # ssl_certificate_key {SSL_KEY_PATH};
    #
    # # Redirect HTTP to HTTPS (uncomment if using SSL)
    # if ($scheme != "https") {
    #     return 301 https://$host$request_uri;
    # }
}
